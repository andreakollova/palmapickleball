<!-- ===== Admin header minimalist modern style (final, fixed right align) ===== -->
<style>
  .admin-header {
    --accent: #111; /* accent čierny len pre header */
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 14px;
    flex-wrap: wrap;
    padding: 4px 0;
  }

  /* Title */
  .admin-header .title {
    font-size: 1.35rem;
    font-weight: 600;
    color: var(--ink);
    letter-spacing: -0.01em;
  }

  /* Left cluster (title + filters) */
  .header-left {
    display: flex;
    align-items: center;
    gap: 18px;
    flex-wrap: wrap;
  }

  .filters { display: flex; gap: 6px; }
  .filter-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--ink);
    font-size: 0.9rem;
    font-weight: 500;
    border-radius: 10px;
    padding: 6px 12px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .filter-btn:hover { background: #f7f8fa; }
  .filter-btn.active {
    background: #f3f4f6;       /* svetlé pozadie */
    color: #111;               /* čierny text */
    border-color: #d1d5db;     /* jemná sivá hranica */
  }

  /* Right cluster (search + sort) — celý blok doprava */
  .header-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    flex: 1;                    /* vyplní zvyšok riadku */
    justify-content: flex-end;  /* ⬅️ zarovnanie doprava */
  }

  /* Search */
  .search-wrapper { position: relative; }
  .search-wrapper input {
    width: 0;
    opacity: 0;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 6px 10px;
    font-size: 0.9rem;
    transition: width 0.2s ease, opacity 0.2s ease;
  }
  .search-wrapper.open input { width: 250px; opacity: 1; }
  .search-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted);
    border-radius: 10px;
    padding: 6px 10px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .search-btn:hover { color: var(--ink); background: #f7f8fa; }

  /* Sort (drž sa úplne vpravo spolu so searchom) */
  .sort {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-left: 130px;         /* posun doprava, ponechané */
    justify-content: flex-end;
  }
  .sort-label {
    font-size: 0.9rem;
    color: var(--muted);
    font-weight: 500;
  }
  .sort-btn {
    background: transparent;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 6px 10px;
    cursor: pointer;
    color: var(--muted);
    transition: all 0.15s ease;
  }
  .sort-btn.active {
    background: #f3f4f6;
    color: #111;
    border-color: #d1d5db;
  }
  .sort-btn:hover { background: #f7f8fa; color: var(--ink); }
</style>

<div class="admin-header">
  <div class="header-left">
    <div class="title">Rezervácie</div>
    <div class="filters" id="filters">
      <button class="filter-btn active" data-filter="all">Všetky</button>
      <button class="filter-btn" data-filter="upcoming">Nadchádzajúce</button>
      <button class="filter-btn" data-filter="today" id="todayBtn">Dnes</button>
    </div>
  </div>

  <div class="header-right">
    <div class="search-wrapper" id="searchBox">
      <button class="search-btn" id="searchToggle" title="Hľadať">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <input type="text" id="searchInput" placeholder="" />
    </div>

    <div class="sort" id="sorters">
      <span class="sort-label">Zoradiť podľa:</span>
      <button class="sort-btn active" data-sort="slot" title="Podľa času slotu">
        <i class="fa-regular fa-bell"></i>
      </button>
      <button class="sort-btn" data-sort="created" title="Podľa dátumu rezervácie">
        <i class="fa-regular fa-clock"></i>
      </button>
    </div>
  </div>
</div>

<script>
(function(){
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  // Dnes label
  (function(){
    const map = ['NE','PO','UT','ST','ŠT','PI','SO'];
    const d = new Date();
    const tag = map[d.getDay()];
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const yyyy = d.getFullYear();
    const t = $('#todayBtn');
    if(t) t.textContent = `Dnes (${tag}, ${dd}.${mm}.${yyyy})`;
  })();

  // Search toggle
  const searchBox    = $('#searchBox');
  const searchToggle = $('#searchToggle');
  const searchInput  = $('#searchInput');
  searchToggle.addEventListener('click', ()=>{
    searchBox.classList.toggle('open');
    if(searchBox.classList.contains('open')) searchInput.focus();
    applyFilters(); // nech sa prefiltruje hneď po otvorení/zatvorení
  });
  searchInput.addEventListener('input', applyFilters);

  // Filters
  let activeFilter = 'all';
  $('#filters').addEventListener('click', e=>{
    const btn = e.target.closest('.filter-btn');
    if(!btn) return;
    activeFilter = btn.dataset.filter;
    $$('.filter-btn').forEach(b=>b.classList.toggle('active', b===btn));
    applyFilters();
  });

  // Sort
  let sortMode = 'slot';
  $('#sorters').addEventListener('click', e=>{
    const b = e.target.closest('.sort-btn');
    if(!b) return;
    sortMode = b.dataset.sort;
    $$('.sort-btn').forEach(s=>s.classList.toggle('active', s===b));
    applyFilters(true);
  });

  // ===== Robustné čítanie dátumu/času slotu =====
  function parseSlot(article){
    // 1) Skús prečítať spoľahlivé zdroje: .status-dot[data-date][data-time] alebo .wtag[data-iso]
    const dot = article.querySelector('.status-dot');
    const wtag = article.querySelector('.wtag');

    const isoDate = (dot && dot.getAttribute('data-date'))
                 || (wtag && wtag.getAttribute('data-iso'))
                 || null; // očakávame YYYY-MM-DD

    // 2) Čas – prvý výskyt HH:MM z .time (ignorujeme koniec rozsahu)
    const timeText = (article.querySelector('.time')?.textContent || '').replace(/\u00a0/g,' ').trim();
    const m = timeText.match(/(\d{1,2}):(\d{2})/); // tolerantné (01-23):(00-59)
    const hh = m ? parseInt(m[1],10) : 0;
    const mi = m ? parseInt(m[2],10) : 0;

    if(isoDate && /^\d{4}-\d{2}-\d{2}$/.test(isoDate)){
      const [Y,M,D] = isoDate.split('-').map(Number);
      return new Date(Y, M-1, D, hh, mi, 0, 0);
    }

    // 3) Fallback: pokús sa rozparsovať z textovej .dt (napr. "25. 10. 2025")
    const dtRaw = (article.querySelector('.dt')?.textContent || '')
      .replace(/\u00a0/g, ' ')
      .trim();
    // najprv skúsiť YYYY-MM-DD…
    if(/^\d{4}-\d{2}-\d{2}$/.test(dtRaw)){
      const [Y,M,D] = dtRaw.split('-').map(Number);
      return new Date(Y, M-1, D, hh, mi, 0, 0);
    }
    // …inak DD.MM.YYYY (s prípadnými medzerami)
    const parts = dtRaw.replace(/\s/g,'').split('.').filter(Boolean);
    if(parts.length >= 3){
      const D = parseInt(parts[0],10);
      const M = parseInt(parts[1],10);
      const Y = parseInt(parts[2],10);
      if(!Number.isNaN(D) && !Number.isNaN(M) && !Number.isNaN(Y)){
        return new Date(Y, M-1, D, hh, mi, 0, 0);
      }
    }
    // ak sa nič nepodarí, vráť "najnižší" dátum
    return new Date(0);
  }

  function parseCreated(article){
    // čítame z textu "Zaplatené: dd.mm.yyyy"
    const txt = article.querySelector('.paid')?.textContent || '';
    const m = txt.match(/Zaplatené:\s*(\d{2})\.(\d{2})\.(\d{4})/);
    if(!m) return new Date(0);
    return new Date(+m[3], +m[2]-1, +m[1], 0, 0, 0, 0);
  }

  function isUpcoming(article){
    const now = new Date();
    const start = parseSlot(article);
    return start > now;
  }

  function isToday(article){
    const start = parseSlot(article);
    const now = new Date();
    return start.getFullYear()===now.getFullYear() &&
           start.getMonth()===now.getMonth() &&
           start.getDate()===now.getDate();
  }

  function applyFilters(doSort=false){
    const term = searchBox.classList.contains('open') ? (searchInput.value||'').toLowerCase() : '';
    const list = $$('.card-body .res');

    // 1) Filtruj podľa tlačidiel + vyhľadávania
    list.forEach(a=>{
      let show = true;
      if(activeFilter==='upcoming') show = isUpcoming(a);
      if(activeFilter==='today')    show = isToday(a);
      if(show && term){
        const blob = (a.textContent||'').toLowerCase();
        show = blob.includes(term);
      }
      a.style.display = show ? '' : 'none';
    });

    // 2) Zoradenie len viditeľných (ak sa klikol sort)
    if(doSort){
      const visible = list.filter(a=>a.style.display!=='none');
      // appenduj vždy do reálneho zoznamu, nie do .card-body
      const container = document.getElementById('resList') || document.querySelector('.card-body');
      visible.sort((a,b)=>{
        return sortMode==='created'
          ? (parseCreated(b) - parseCreated(a))
          : (parseSlot(b)    - parseSlot(a));
      });
      visible.forEach(a=>container.appendChild(a));
    }
  }

  // prvé vykonanie
  applyFilters();
})();
</script>
