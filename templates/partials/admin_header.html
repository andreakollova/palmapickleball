<!-- ===== Admin header minimalist modern style (final, fixed right align) ===== -->
<style>
  .admin-header {
    --accent: #111; /* accent ƒçierny len pre header */
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 14px;
    flex-wrap: wrap;
    padding: 4px 0;
  }

  /* Title */
  .admin-header .title {
    font-size: 1.35rem;
    font-weight: 600;
    color: var(--ink);
    letter-spacing: -0.01em;
  }

  /* Left cluster (title + filters) */
  .header-left {
    display: flex;
    align-items: center;
    gap: 18px;
    flex-wrap: wrap;
  }

  .filters { display: flex; gap: 6px; }
  .filter-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--ink);
    font-size: 0.9rem;
    font-weight: 500;
    border-radius: 10px;
    padding: 6px 12px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .filter-btn:hover { background: #f7f8fa; }
  .filter-btn.active {
    background: #f3f4f6;
    color: #111;
    border-color: #d1d5db;
  }

  /* Right cluster (search + sort) */
  .header-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    flex: 1;
    justify-content: flex-end;
  }

  /* Search */
  .search-wrapper { position: relative; }
  .search-wrapper input {
    width: 0;
    opacity: 0;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 6px 10px;
    font-size: 0.9rem;
    transition: width 0.2s ease, opacity 0.2s ease;
  }
  .search-wrapper.open input { width: 250px; opacity: 1; }
  .search-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted);
    border-radius: 10px;
    padding: 6px 10px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .search-btn:hover { color: var(--ink); background: #f7f8fa; }

  /* Sort */
  .sort {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-left: 130px;
    justify-content: flex-end;
  }
  .sort-label {
    font-size: 0.9rem;
    color: var(--muted);
    font-weight: 500;
  }
  .sort-btn {
    background: transparent;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 6px 10px;
    cursor: pointer;
    color: var(--muted);
    transition: all 0.15s ease;
  }
  .sort-btn.active {
    background: #f3f4f6;
    color: #111;
    border-color: #d1d5db;
  }
  .sort-btn:hover { background: #f7f8fa; color: var(--ink); }
</style>

<div class="admin-header">
  <div class="header-left">
    <div class="title">Rezerv√°cie</div>
    <div class="filters" id="filters">
      <button class="filter-btn active" data-filter="all">V≈°etky</button>
      <button class="filter-btn" data-filter="upcoming">Nadch√°dzaj√∫ce</button>
      <button class="filter-btn" data-filter="today" id="todayBtn">Dnes</button>
    </div>
  </div>

  <div class="header-right">
    <div class="search-wrapper" id="searchBox">
      <button class="search-btn" id="searchToggle" title="Hƒæada≈•">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <input type="text" id="searchInput" placeholder="" />
    </div>

    <div class="sort" id="sorters">
      <span class="sort-label">Zoradi≈• podƒæa:</span>
      <button class="sort-btn active" data-sort="slot" title="Podƒæa ƒçasu slotu">
        <i class="fa-regular fa-bell"></i>
      </button>
      <button class="sort-btn" data-sort="created" title="Podƒæa d√°tumu rezerv√°cie">
        <i class="fa-regular fa-clock"></i>
      </button>
    </div>
  </div>
</div>

<script>
(function(){
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  // Dnes label
  (function(){
    const map = ['NE','PO','UT','ST','≈†T','PI','SO'];
    const d = new Date();
    const tag = map[d.getDay()];
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const yyyy = d.getFullYear();
    const t = $('#todayBtn');
    if(t) t.textContent = `Dnes (${tag}, ${dd}.${mm}.${yyyy})`;
  })();

  // Search toggle + live search
  const searchBox    = $('#searchBox');
  const searchToggle = $('#searchToggle');
  const searchInput  = $('#searchInput');

  searchToggle.addEventListener('click', ()=>{
    searchBox.classList.toggle('open');
    if(searchBox.classList.contains('open')) searchInput.focus();
    applyFilters();
    // üîÅ also refresh pagination after click
    if (window.repaginate) window.repaginate(false);
  });

  // merged REAL-TIME handler (replaces your two separate 'input' listeners)
  searchInput.addEventListener('input', ()=>{
    applyFilters();
    if (searchInput.value.trim()) searchBox.classList.add('open');

    // üîÅ tell pagination to recompute after each keystroke
    if (window.repaginate) window.repaginate(false);
  });

  searchInput.addEventListener('focus', ()=>{
    searchBox.classList.add('open');
  });

  // Filters
  let activeFilter = 'all';
  $('#filters').addEventListener('click', e=>{
    const btn = e.target.closest('.filter-btn');
    if(!btn) return;
    activeFilter = btn.dataset.filter;
    $$('.filter-btn').forEach(b=>b.classList.toggle('active', b===btn));
    applyFilters();
    // optional: jump pagination to first page when filter changes
    if (window.repaginate) window.repaginate(false);
  });

  // Sort
  let sortMode = 'slot';
  $('#sorters').addEventListener('click', e=>{
    const b = e.target.closest('.sort-btn');
    if(!b) return;
    sortMode = b.dataset.sort;
    $$('.sort-btn').forEach(s=>s.classList.toggle('active', s===b));
    applyFilters(true);
    // after sorting, page 1 of the sorted results
    if (window.repaginate) window.repaginate(false);
  });

  // ===== Robustn√© ƒç√≠tanie d√°tumu/ƒçasu slotu =====
  function parseSlot(article){
    const dot = article.querySelector('.status-dot');
    const wtag = article.querySelector('.wtag');
    const isoDate = (dot && dot.getAttribute('data-date')) || (wtag && wtag.getAttribute('data-iso')) || null;
    const timeText = (article.querySelector('.time')?.textContent || '').replace(/\u00a0/g,' ').trim();
    const m = timeText.match(/(\d{1,2}):(\d{2})/);
    const hh = m ? parseInt(m[1],10) : 0;
    const mi = m ? parseInt(m[2],10) : 0;
    if(isoDate && /^\d{4}-\d{2}-\d{2}$/.test(isoDate)){
      const [Y,M,D] = isoDate.split('-').map(Number);
      return new Date(Y, M-1, D, hh, mi, 0, 0);
    }
    const dtRaw = (article.querySelector('.dt')?.textContent || '').replace(/\u00a0/g, ' ').trim();
    if(/^\d{4}-\d{2}-\d{2}$/.test(dtRaw)){
      const [Y,M,D] = dtRaw.split('-').map(Number);
      return new Date(Y, M-1, D, hh, mi, 0, 0);
    }
    const parts = dtRaw.replace(/\s/g,'').split('.').filter(Boolean);
    if(parts.length >= 3){
      const D = parseInt(parts[0],10);
      const M = parseInt(parts[1],10);
      const Y = parseInt(parts[2],10);
      if(!Number.isNaN(D) && !Number.isNaN(M) && !Number.isNaN(Y)){
        return new Date(Y, M-1, D, hh, mi, 0, 0);
      }
    }
    return new Date(0);
  }

  function parseCreated(article){
    const txt = article.querySelector('.paid')?.textContent || '';
    const m = txt.match(/Zaplaten√©:\s*(\d{2})\.(\d{2})\.(\d{4})/);
    if(!m) return new Date(0);
    return new Date(+m[3], +m[2]-1, +m[1], 0, 0, 0, 0);
  }

  function isUpcoming(article){
    const now = new Date();
    const start = parseSlot(article);
    return start > now;
  }

  function isToday(article){
    const start = parseSlot(article);
    const now = new Date();
    return start.getFullYear()===now.getFullYear() &&
           start.getMonth()===now.getMonth() &&
           start.getDate()===now.getDate();
  }

  // --- helpery ---
  function stripDiacritics(s=''){ return s.normalize('NFD').replace(/[\u0300-\u036f]/g, ''); }
  function digitsOnly(s=''){ return s.replace(/\D+/g,''); }

  /* ‚úÖ FILTER + SORT LOGIKA (nezmenen√© okrem refaktorovania pre ƒçistotu) */
  function applyFilters(doSort = false) {
    const container = document.getElementById('resList') || document.querySelector('.card-body');
    const list = Array.from(container.querySelectorAll('.res'));
    list.forEach(el => el.classList.remove('pg-hidden'));

    const rawTerm    = (searchInput.value || '');
    const term       = rawTerm.trim().toLowerCase();
    const termNorm   = term.normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    const termDigits = term.replace(/\D/g,'');

    list.forEach(a => {
      let show = true;
      if (activeFilter === 'upcoming') show = isUpcoming(a);
      if (activeFilter === 'today')    show = isToday(a);

      if (show && term) {
        const nameEl = a.querySelector('.name');
        const subEl  = a.querySelector('.sub');
        const nameText = (nameEl?.textContent || '').replace(/\s+/g,' ').trim().toLowerCase();
        const subText  = (subEl?.textContent  || '').replace(/\s+/g,' ').trim().toLowerCase();
        const combined      = `${nameText} ${subText}`;
        const combinedNorm  = combined.normalize('NFD').replace(/[\u0300-\u036f]/g,'');
        const subDigitsOnly = subText.replace(/\D/g,'');
        const textMatch  = combinedNorm.includes(termNorm);
        const phoneMatch = (termDigits && termDigits.length >= 3 && subDigitsOnly.includes(termDigits));
        show = textMatch || phoneMatch;
      }
      a.style.display = show ? '' : 'none';
    });

    if (doSort) {
      const visible = list.filter(a => a.style.display !== 'none');
      visible.sort((a,b)=>{
        return sortMode === 'created'
          ? (parseCreated(b) - parseCreated(a))
          : (parseSlot(b) - parseSlot(a));
      });
      visible.forEach(a => container.appendChild(a));
    }
  }

  // prv√© vykonanie
  applyFilters();
})();
</script>
