{% extends "base.html" %}
{% block title %}Rezerv√°cia bola √∫spe≈°n√°{% endblock %}

{% block content %}

<style>
  :root{
    --accent:#3a38d6;
    --border:#e7e9ef;
    --muted:#667085;
    --shadow:0 6px 24px rgba(16, 24, 40, .06);
  }

  .success-wrap{
    background: linear-gradient(180deg, #ffffff 0%, #fafbff 100%);
    padding: 32px 0 64px;
  }
  .success-wrap .container-narrow{
    width:100%; max-width:960px; margin:0 auto; padding:0 24px;
  }
  @media (max-width:575.98px){
    .success-wrap{padding:20px 0 40px;}
    .success-wrap .container-narrow{padding:0 16px;}
  }

  .card-plain{
    border:1px solid var(--border);
    border-radius:16px;
    background:#fff;
    box-shadow:var(--shadow);
  }

  .ok-icon{
    width:78px;height:78px;border-radius:999px;
    background:rgba(58,56,214,.1);
    display:flex;align-items:center;justify-content:center;
    margin:0 auto 16px;
  }
  .ok-icon svg{width:38px;height:38px;stroke:var(--accent);}

  .h-title{
    font-weight:800; letter-spacing:.01em;
    text-align:center;
    font-size: clamp(1.4rem, 1.1rem + 1.2vw, 2rem);
  }
  .h-sub{color:var(--muted); text-align:center; margin:8px 0 22px;}

  .details{
    padding:18px 18px;
    border:1px dashed var(--border);
    border-radius:12px;
    background:#f9fafc;
  }
  .dl{display:grid; grid-template-columns: 120px 1fr; gap:10px 16px; margin:0;}
  .dl .dt{color:#667085;}
  .dl .dd{color:#111827; font-weight:600;}

  .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:center;}
  .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px;
       padding:.65rem 1rem; border-radius:10px; border:1px solid var(--border);
       background:#fff; color:#111; text-decoration:none;}
  .btn-dark{background:#111827; color:#fff; border-color:#111827;}
  .btn-accent{background:var(--accent); border-color:var(--accent); color:#fff;}
  .btn:hover{filter:brightness(.98); text-decoration:none;}

  .grid{display:grid; grid-template-columns: 1fr 1fr; gap:18px;}
  @media (max-width: 991.98px){ .grid{grid-template-columns: 1fr;} }

  .box-head{font-weight:700; font-size:1.05rem;}
  .muted{color:var(--muted);}
  .form .form-label{font-size:.95rem; font-weight:500; margin-bottom:.35rem;}
  .form .form-control{padding:.6rem .75rem; border-color:#e5e7eb;}
  .small-note{font-size:.9rem; color:var(--muted);}
  .sep{height:1px;background:#eff1f5;margin:14px 0;}

  .success-note{
    border:1px solid #e6f4ea;
    background:#f4fbf6;
    color:#14532d;
    border-radius:12px;
    padding:12px 14px;
  }

  /* Benefits list (smaller text) */
  .benefits{list-style:none;margin:10px 0 12px 0;padding:0;display:grid;gap:8px;}
  .benefits li{
    display:flex;gap:10px;align-items:flex-start;color:#1f2937;
    font-size:.9rem; /* ‚Üê adjust size here */
  }
  .benefits .dot{
    width:10px;height:10px;border-radius:999px;flex:0 0 10px;
    margin-top:6px;background:var(--accent);box-shadow:0 0 0 3px rgba(58,56,214,.12);
  }

  /* Signup card + floating chip */
  .signup-card{position:relative;}
  .info-chip{
    position:absolute;
    top:14px; right:14px;
    border:1px solid #e6e9ff;
    background:#f6f7ff;
    color:#1f2a6b;
    border-radius:999px;
    padding:8px 12px;
    font-size:.85rem;  /* ‚Üê adjust the chip size here */
    line-height:1;
    box-shadow:0 2px 8px rgba(18, 44, 110, .05);
    white-space:nowrap;
  }
  @media (max-width:575.98px){
    .info-chip{
      position:static;
      display:inline-block;
      margin-bottom:10px;
      border-radius:12px;
      white-space:normal;
    }
  }
</style>

<section class="success-wrap">
  <div class="container-narrow">
    <div class="grid">

      <!-- LEFT: Booking summary -->
      <div class="card-plain p-4 p-md-5">
        <div class="ok-icon">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M20 7L9 18l-5-5" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h1 class="h-title">Rezerv√°cia bola √∫spe≈°n√° üéâ</h1>
        <p class="h-sub">Tvoja platba prebehla √∫spe≈°ne a kurt je rezervovan√Ω. Te≈°√≠me sa na tvoju hru!</p>

        <div class="details mb-3">
          <div class="dl">
            <div class="dt">Kurt</div>
            <div class="dd">{{ court or "‚Äî" }}</div>

            <div class="dt">D√°tum</div>
            <div class="dd">{{ date or "‚Äî" }}</div>

            <div class="dt">ƒåas</div>
            <div class="dd">{{ time or "‚Äî" }}</div>

            <div class="dt">Suma</div>
            <div class="dd">{{ total or "‚Äî" }}</div>
          </div>
        </div>

        <div class="actions mt-2">
          <a href="{{ url_for('index') }}" class="btn">Sp√§≈• na hlavn√∫ str√°nku</a>
        </div>
      </div>

      <!-- RIGHT: Signup card -->
      <div class="card-plain signup-card p-4 p-md-5">

        {% if request.args.get('registered') %}
          <div class="success-note mb-3">
            Tvoj √∫ƒçet bol vytvoren√Ω. M√¥≈æe≈° sa prihl√°si≈• a spravova≈• svoje rezerv√°cie.
          </div>
          <div class="actions mt-2">
            <a href="/dashboard" class="btn btn-accent">Prejs≈• do m√¥jho profilu</a>
            <a href="{{ url_for('index') }}" class="btn">Sp√§≈• na hlavn√∫ str√°nku</a>
          </div>
        {% else %}
          <div class="mb-2">
            <div class="box-head">Vytvori≈• √∫ƒçet zadarmo (odpor√∫ƒçame)</div>
          </div>

          <ul class="benefits">
            <li><span class="dot"></span><span><strong>Spravuj rezerv√°cie</strong> ‚Äì zmeny a prehƒæad na jednom mieste.</span></li>
            <li><span class="dot"></span><span><strong>V√Ωhody a zƒæavy</strong> ‚Äì ƒçlenstvo, akcie a priorita na booking.</span></li>
            <li><span class="dot"></span><span><strong>Komunita Palma Pickleball</strong> ‚Äì turnaje, sparingy, novinky.</span></li>
          </ul>

          <form method="post" action="{{ url_for('registracia_po_objednavke') }}" class="form" novalidate>
            <!-- E-mail from booking (readonly) -->
            <div class="mb-3">
              <label class="form-label">E-mail</label>
              <input class="form-control" type="email" name="email"
                     value="{{ email or request.args.get('email','') }}"
                     placeholder="tvoj@email.sk" required readonly>
            </div>

            <div class="mb-3">
              <label class="form-label">Heslo</label>
              <input class="form-control" type="password" name="password" id="pw1"
                     placeholder="Zvoƒæ si heslo" minlength="6" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Potvrdi≈• heslo</label>
              <input class="form-control" type="password" id="pw2"
                     placeholder="Zopakuj heslo" minlength="6" required>
              <div id="pwErr" class="small text-danger mt-1" style="display:none;">Hesl√° sa nezhoduj√∫.</div>
            </div>

            <!-- pass booking info back; server handles redirect -->
            <input type="hidden" name="next_path" value="{{ url_for('rezervacia_uspesna') }}">
            <input type="hidden" name="date"  value="{{ date  or '' }}">
            <input type="hidden" name="time"  value="{{ time  or '' }}">
            <input type="hidden" name="court" value="{{ court or '' }}">
            <input type="hidden" name="total" value="{{ total or '' }}">

            <div class="sep"></div>

            <button class="btn btn-accent w-100" type="submit">Vytvori≈• √∫ƒçet</button>
            <div class="small-note mt-2">
              Po registr√°cii si v profile m√¥≈æe≈° spravova≈• rezerv√°cie, fakturaƒçn√© √∫daje a hist√≥riu platieb.
            </div>
          </form>
        {% endif %}
      </div>

    </div>
  </div>
</section>

<script>
  // jednoduch√° kontrola zhody hesiel
  (function(){
    const form = document.querySelector('form[action="{{ url_for("registracia_po_objednavke") }}"]');
    if(!form) return;
    const p1 = document.getElementById('pw1');
    const p2 = document.getElementById('pw2');
    const err = document.getElementById('pwErr');

    function check(){
      if(!p1.value || !p2.value) { err.style.display='none'; return true; }
      if(p1.value !== p2.value){ err.style.display='block'; return false; }
      err.style.display='none'; return true;
    }
    p1.addEventListener('input', check);
    p2.addEventListener('input', check);
    form.addEventListener('submit', (e)=>{ if(!check()){ e.preventDefault(); p2.focus(); } });
  })();
</script>

{% endblock %}
