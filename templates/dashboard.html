{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<style>
  :root{
    --accent:#3a38d6;
    --border:#e7e9ef;
    --muted:#667085;
    --ink:#111;
    --bg-grad: linear-gradient(180deg, #ffffff 0%, #fafbff 100%);
    --shadow: 0 6px 24px rgba(16,24,40,.06);
  }

  .dash-wrap{background:var(--bg-grad); padding:24px 0 48px;}
  .dash-container{max-width:1100px; margin:0 auto; padding:0 24px;}
  @media (max-width:575.98px){ .dash-container{padding:0 16px;} }

  /* ===== Layout ===== */
  .dash-grid{display:grid; grid-template-columns: 240px 1fr; gap:18px;}
  @media (max-width: 992px){ .dash-grid{grid-template-columns: 1fr;} }

  /* ===== Sidebar ===== */
  .side{
    border:1px solid var(--border);
    border-radius:14px;
    background:#fff;
    box-shadow:var(--shadow);
    padding:16px;
    position:sticky; top:92px;
    height:fit-content;
  }
  .mebox{display:flex; gap:12px; align-items:center; border-bottom:1px dashed var(--border); padding-bottom:12px; margin-bottom:12px;}
  .avatar{width:46px;height:46px;border-radius:999px;object-fit:cover;border:1px solid #eef0f5;background:#f6f7fb;}
  .hello{font-weight:700; letter-spacing:.01em; color:var(--ink);}
  .hello .sub{display:none;} /* removed subtitle */

  .navlist{list-style:none; padding:0; margin:0;}
  .navlist li{margin:2px 0;}
  .navlink{
    display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:10px;
    color:#111; text-decoration:none; border:1px solid transparent;
  }
  .navlink:hover{background:#fafbff; border-color:#eef0f5; text-decoration:none;}
  .navlink.active{background:#f3f4ff; border-color:#dfe1ff; color:#2b2acb;}

  /* ===== Content card ===== */
  .card{border:1px solid var(--border); border-radius:14px; background:#fff; box-shadow:var(--shadow);}
  .card-head{padding:18px 18px; border-bottom:1px solid var(--border);}
  .card-body{padding:18px;}

  /* ===== Buttons (match site: outline + filled purple, slimmer like screenshot) ===== */
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:8px;
    padding:.48rem .9rem; /* slimmer vertical padding */
    border-radius:12px; border:1px solid var(--border);
    background:#fff; color:#111; text-decoration:none; font-weight:600;
    line-height:1.15;
    font-weight:400;
    transition:filter .08s ease, background .08s ease, border-color .08s ease;
  }
  .btn:hover{filter:brightness(.98); text-decoration:none;}
  .btn-accent{
    background:var(--accent); border-color:var(--accent); color:#fff;
  }

  /* ===== Table ===== */
  .table-wrap{overflow:auto;}
  table{width:100%; border-collapse:separate; border-spacing:0;}
  thead th{
    font-size:.92rem; color:var(--muted); font-weight:600; text-align:left;
    border-bottom:1px solid var(--border); padding:10px 12px; white-space:nowrap;
  }
  tbody td{padding:12px; border-bottom:1px solid #f1f2f6; vertical-align:middle;}
  tbody tr:last-child td{border-bottom:none;}

  .badge{
    display:inline-block; padding:4px 8px; border-radius:999px; font-size:.8rem;
    border:1px solid #e1e4ff; background:#f5f6ff; color:#2b2acb;
  }
  .link{color:var(--accent); text-decoration:none;}
  .link:hover{text-decoration:underline;}
  .muted{color:#9aa3af;}
</style>

<section class="dash-wrap">
  <div class="dash-container">
    <div class="dash-grid">

      <!-- Sidebar -->
      <aside class="side">
        <div class="mebox">
          <img
            src="{{ user_photo or url_for('static', filename='images/profile1.png') }}"
            class="avatar" alt="Profilová fotka">
          <div class="hello">Ahoj, {{ user_name or 'Andrea' }}!</div>
        </div>

        <ul class="navlist">
          <li><a class="navlink active" href="{{ url_for('dashboard') }}">Rezervácie</a></li>
          <li><a class="navlink" href="/profil">Profil</a></li>
          <li><a class="navlink" href="{{ url_for('index') }}">Domovská stránka</a></li>
        </ul>
      </aside>

      <!-- Content -->
      <main class="card">
        <div class="card-head d-flex align-items-center justify-content-between flex-wrap">
          <div>
            <div class="hello" style="font-size:1.1rem;">Tvoje rezervácie</div>
          </div>
          <div class="d-flex gap-2 mt-2 mt-lg-0">
            <a class="btn btn-accent" href="{{ url_for('index') }}#rezervacia">Rezervovať kurt</a>
          </div>
        </div>

        <div class="card-body">
          {% if reservations and reservations|length %}
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Dátum</th>
                    <th>Čas</th>
                    <th>Kurt</th>
                    <th>Cena</th>
                    <th>Video</th>
                  </tr>
                </thead>
                <tbody>
                {% for r in reservations %}
                  <tr>
                    <!-- Format 2025-10-17 -> 17. 10. 2025 -->
                    <td>
                      {% set d = r.date|string %}
                      {% if d|length == 10 and '-' in d %}
                        {% set y = d[0:4] %}{% set m = d[5:7] %}{% set dd = d[8:10] %}
                        {{ dd }}. {{ m }}. {{ y }}
                      {% else %}
                        {{ r.date }}
                      {% endif %}
                    </td>
                    <td>{{ r.time }}</td>
                    <td><span class="badge">{{ r.court }}</span></td>
                    <td><strong>{{ r.total }}</strong></td>
                    <td>
                      {% if r.video_url %}
                        <a class="link" href="{{ r.video_url }}" target="_blank" rel="noopener">Stiahnuť</a>
                      {% else %}
                        <span class="muted">—</span>
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="text-center" style="color:var(--muted);">
              Zatiaľ nemáš žiadne rezervácie.
              <div class="mt-3">
                <a class="btn btn-accent" href="{{ url_for('index') }}#rezervacia">Rezervovať kurt</a>
              </div>
            </div>
          {% endif %}
        </div>
      </main>

    </div>
  </div>
</section>
{% endblock %}
